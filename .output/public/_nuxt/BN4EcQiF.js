import x from"./DSvAjhnG.js";import{_ as w,r as _,j as T,K as B,O as E,L as b,x as I,I as v,p as $,P as D,c as p,M as C,f as H,a as f,t as L,o as u}from"#entry";import"./BCfo2Fq6.js";const M=globalThis.setInterval,R={class:"section"},j={key:0,class:"container mx-auto px-4 py-8"},A={class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},N={key:1,class:"container mx-auto px-4 py-8"},P="published",O={__name:"_slug",async setup(V){let n,l;const o=_(null),c=_(null),g=_(!0),{$gtag:a}=T(),{slug:r}=B().params;try{const t=E(),e=([n,l]=b(()=>fetch(`https://api.storyblok.com/v2/cdn/stories/blog/${r}?version=${P}&token=${t.public.storyblokApiToken}`,{headers:{"Content-Type":"application/json"}})),n=await n,l(),n);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const s=([n,l]=b(()=>e.json()),n=await n,l(),n);s.story?o.value=s.story:c.value="Blog post not found"}catch(t){c.value=`Failed to load blog post: ${t.message}`}finally{g.value=!1}return I(o,t=>{t&&t.content&&a&&a("event","blog_view",{blog_title:t.content.name,blog_slug:r,blog_intro:t.content.intro,blog_created_at:t.created_at,blog_updated_at:t.updated_at,content_type:"therapy_blog"})},{immediate:!0}),v(()=>{if(o.value&&a){let t=0,e=!1;const s=()=>{const i=window.pageYOffset||document.documentElement.scrollTop,k=document.documentElement.scrollHeight-window.innerHeight,d=Math.round(i/k*100);d>t&&(t=d,[25,50,75,100].includes(d)&&!e&&(a("event","blog_scroll_depth",{blog_title:o.value.content.name,blog_slug:r,scroll_percent:d,content_type:"therapy_blog"}),e=!0))};window.addEventListener("scroll",s);let h=Date.now(),m=!1;const y=M(()=>{const i=Math.round((Date.now()-h)/1e3);[30,60,120,300].includes(i)&&!m&&(a("event","blog_reading_time",{blog_title:o.value.content.name,blog_slug:r,time_spent_seconds:i,content_type:"therapy_blog"}),m=!0)},1e3);$(()=>{window.removeEventListener("scroll",s),clearInterval(y)})}}),v(()=>{const{storybridge:t}=D();t.on(["input","published","change"],e=>{e.action==="input"?e.story.id===o.value?.id&&(o.value=e.story):window.location.reload()})}),(t,e)=>{const s=x;return u(),p("section",R,[c.value?(u(),p("div",j,[f("div",A,L(c.value),1)])):g.value?(u(),p("div",N,[...e[0]||(e[0]=[f("div",{class:"text-center"},"Loading blog post...",-1)])])):o.value?(u(),C(s,{key:2,blok:o.value.content},null,8,["blok"])):H("",!0)])}}},Y=w(O,[["__scopeId","data-v-2900ab05"]]);export{Y as default};
